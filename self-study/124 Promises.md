# 124 Promises. ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹ Ð´Ð»Ñ ÑÐ°Ð¼Ð¾ÑÑ‚Ð¾ÑÑ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ð¸Ð·ÑƒÑ‡ÐµÐ½Ð¸Ñ.

## ÐŸÑ€Ð¾Ð¼Ð¸ÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ

ÐœÑ‹ Ñ Ð²Ð°Ð¼Ð¸ Ñ€Ð°Ð·Ð¾Ð±Ñ€Ð°Ð»Ð¸ Ð´Ð²Ð° ÑÐ¿Ð¾ÑÐ¾Ð±Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¼Ð¸ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑÐ¼Ð¸. ÐŸÐµÑ€Ð²Ñ‹Ð¹ - Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð¸ ÐºÐ¾Ð»Ð»Ð±ÑÐºÐ°, Ð° Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¿Ñ€Ð¾Ð¼Ð¸ÑÐ¾Ð². ÐÐ¾ Ñ‡Ñ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ ÐµÑÐ»Ð¸ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ ÐºÐ¾Ð»Ð»Ð±ÑÐº, Ð° Ð½Ð°Ð¼ Ð½ÑƒÐ¶ÐµÐ½ Ð¿Ñ€Ð¾Ð¼Ð¸Ñ? Ð§Ñ‚Ð¾Ð±Ñ‹ Ñ€ÐµÑˆÐ¸Ñ‚ÑŒ ÑÑ‚Ñƒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñƒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ "Ð¿Ñ€Ð¾Ð¼Ð¸ÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸ÑŽ".

Ðš Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñƒ, `setTimeout` Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ ÐºÐ¾Ð»Ð»Ð±ÑÐº, Ð½Ð¾ Ð½Ðµ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¿Ñ€Ð¾Ð¼Ð¸Ñ. Ð”Ð°Ð²Ð°Ð¹ ÑÐ´ÐµÐ»Ð°ÐµÐ¼ Ð½Ð¾Ð²ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ setTimeoutPromised, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð±ÑƒÐ´ÐµÑ‚ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð¼Ð¸Ñ:

```js
// ms - Ð²Ñ€ÐµÐ¼Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ¸ Ð² Ð¼Ð¸Ð»Ð»Ð¸ÑÐµÐºÑƒÐ½Ð´Ð°Ñ…
function setTimeoutPromised(ms) {
  return new Promise((resolve, reject) => {
    // Ð¿Ñ€Ð¾Ð¼Ð¸Ñ Ð·Ð°Ñ€ÐµÐ·Ð¾Ð»Ð²Ð¸Ñ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· ms Ð¼Ð¸Ð»Ð»Ð¸ÑÐµÐºÑƒÐ½Ð´
    setTimeout(() => resolve(), ms);
  });
}

// Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ
setTimeoutPromised(2000).then(() => {
  console.log('2 ÑÐµÐºÑƒÐ½Ð´Ñ‹ Ð¿Ñ€Ð¾ÑˆÐ»Ð¾');
});
```

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ `setTimeoutPromised` Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ñ Ð¿Ñ€Ð¾Ð¼Ð¸ÑÐ°Ð¼Ð¸, Ð° Ð½Ðµ Ñ ÐºÐ¾Ð»Ð»Ð±ÑÐºÐ°Ð¼Ð¸.

Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð°, Ð´Ð°Ð²Ð°Ð¹ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð¸Ð¼, Ñ‡Ñ‚Ð¾ Ð¸Ð¼ÐµÐµÐ¼ Ð´ÐµÐ»Ð¾ Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÐµÐ¹ `fs.readFile`, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ ÐºÐ¾Ð»Ð»Ð±ÑÐº Ð¸ Ñƒ Ð½Ð°Ñ Ð½ÐµÑ‚ Ð°Ð½Ð°Ð»Ð¾Ð³Ð° ÑÑ‚Ð¾Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð±Ñ‹ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ð»Ð° Ð¿Ñ€Ð¾Ð¼Ð¸Ñ. Ð’Ð¾Ð¾Ð±Ñ‰Ðµ-Ñ‚Ð¾, Ñ‚Ñ‹ Ð·Ð½Ð°ÐµÑˆÑŒ Ñ‡Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ð¹ Ð°Ð½Ð°Ð»Ð¾Ð³ ÐµÑÑ‚ÑŒ (Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð½ÑƒÐ¶Ð½Ð¾ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ `fs` Ñ‡ÐµÑ€ÐµÐ· `require('fs').promises`), Ð½Ð¾ Ð´Ð°Ð²Ð°Ð¹ Ð²ÐºÐ»ÑŽÑ‡Ð¸Ð¼ Ð²Ð¾Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð¸ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð¸Ð¼, Ñ‡Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ð¹ Ð½ÐµÑ‚ ðŸ™‚

ÐÐ°Ð¿Ð¸ÑˆÐµÐ¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ `readFilePromised`:

```js
const fs = require('fs');

function readFilePromised(path, encoding) {
  return new Promise((resolve, reject) => {
    fs.readFile(path, encoding, (error, data) => {
      if (error) {
        // Ñ€ÐµÐ´Ð¶ÐµÐºÑ‚Ð¸Ð¼ Ð¿Ñ€Ð¾Ð¼Ð¸Ñ ÐµÑÐ»Ð¸ Ð¿Ñ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð°
        reject(error);
      } else {
        // Ñ€ÐµÐ·Ð¾Ð»Ð²Ð¸Ð¼ Ð¿Ñ€Ð¾Ð¼Ð¸Ñ ÐµÑÐ»Ð¸ Ñ„Ð°Ð¹Ð» Ð¿Ñ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð»ÑÑ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾
        resolve(data);
      }
    });
  });
}

// Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ
readFilePromised('/path/to/file', 'utf8')
  .then((data) => {
    console.log(data);
  })
  .catch((error) => {
    console.error(error);
  });
```
